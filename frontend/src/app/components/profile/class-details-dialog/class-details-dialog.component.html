<h2 mat-dialog-title>Деталі заняття</h2>

<mat-dialog-content class="mat-typography">
  <form [formGroup]="classForm" (ngSubmit)="onSubmit()">
    <!-- Student name field -->
    <fieldset *ngIf="isUserTeacher">
      <label class="form-label" for="studentName"><b>Ім'я учня</b></label>
      <select formControlName="studentId" id="studentName" class="form-select">
        <option *ngFor="let s of students$ | async" value="{{ s.id }}">
          {{ s.name }}
        </option>
      </select>
    </fieldset>
    <hr />
    <!-- Class start field -->
    <fieldset>
      <label class="form-label" for="classTime-start"
        ><b>Початок заняття</b></label
      >
      <input
        formControlName="classStart"
        class="form-control"
        type="datetime-local"
        id="classTime-start"
      />
    </fieldset>
    <hr />
    <!-- Class end field -->
    <fieldset>
      <label class="form-label" for="classTime-end"
        ><b>Кінець заняття</b></label
      >
      <input
        formControlName="classEnd"
        class="form-control"
        type="datetime-local"
        id="classTime-end"
      />
    </fieldset>
    <hr />
    <!-- Status field -->
    <fieldset>
      <p class="form-label">
        <b>Статус: </b>
        <span
          *ngIf="classStatus.value === 'OK'; else canceledBadge"
          class="badge text-bg-success"
          >OK</span
        >
        <ng-template #canceledBadge>
          <span class="badge text-bg-danger">Відмінено</span>
        </ng-template>
      </p>
    </fieldset>

    <!-- Cancel class btn -->
    <p *ngIf="editStarted" class="text-danger text-center">
      Скасувати заняття можливо не пізніше, ніж за 12 год
    </p>

    <div class="text-center">
      <!-- Change class status btn -->
      <button
        *ngIf="editStarted"
        [disabled]="!cancellationPolicy()"
        (click)="cancelClass()"
        mat-raised-button
        class="w-75"
        type="button"
      >
        <span *ngIf="classStatus.value === 'OK'"> Скасувати заняття </span>
        <span *ngIf="classStatus.value !== 'OK'"> Відновити заняття </span>
      </button>

      <!-- Save changes btn -->
      <button
        *ngIf="editStarted && (haveDetailsChanged || classForm.touched)"
        type="submit"
        mat-raised-button
        style="background-color: forestgreen; color: #fff"
        class="mt-2 w-75"
      >
        Зберегти зміни
      </button>

      <!--Delete class btn  -->
      <button
        (click)="deleteClass()"
        *ngIf="editStarted && isUserTeacher"
        mat-raised-button
        color="warn"
        type="button"
        class="mt-3 w-75"
      >
        Видалити заняття
      </button>
    </div>
  </form>
</mat-dialog-content>
<mat-dialog-actions align="center">
  <button
    *ngIf="!editStarted"
    (click)="changeEditState()"
    mat-raised-button
    style="background-color: var(--purple)"
    type="button"
  >
    <fa-icon [icon]="editIcon"></fa-icon>
    Редагувати
  </button>
  <!-- Cancel changes btn -->
  <button
    (click)="changeEditState()"
    *ngIf="editStarted"
    mat-raised-button
    color="primary"
    type="button"
  >
    Назад
  </button>
</mat-dialog-actions>
<button
  mat-dialog-close
  type="button"
  class="btn-close closeBtnModal"
  aria-label="Close"
></button>
