<section>
  <!-- Error message -->
  <div
    *ngIf="showErrorMsg"
    class="alert alert-danger alert-dismissible text-center"
    role="alert"
  >
    <div>
      <p>{{ errorMsg }}</p>
    </div>
    <button
      (click)="showErrorMsg = !showErrorMsg"
      type="button"
      class="btn-close"
      data-bs-dismiss="alert"
      aria-label="Close"
    ></button>
  </div>

  <div class="form-wrapper">
    <form [formGroup]="signupForm" (submit)="onSubmit()">
      <legend>–°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å</legend>

      <!-- Name field -->
      <fieldset class="input-group has-validation">
        <div class="input-container">
          <div
            [class.is-invalid]="name.invalid && (name.dirty || name.touched)"
            class="form-floating"
          >
            <input
              [class.is-invalid]="name.invalid && (name.dirty || name.touched)"
              formControlName="name"
              type="text"
              class="form-control"
              placeholder="–Ü–º'—è"
            />
            <label>–Ü–º'—è</label>
          </div>
          <div class="invalid-feedback">
            <div *ngIf="name.hasError('required')">
              <span>–Ü–º'—è –æ–±–æ–≤'—è–∑–∫–æ–≤–µ</span>
            </div>
            <div *ngIf="name.hasError('pattern')">
              <span>–Ü–º'—è –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ –ª–∏—à–µ –ª—ñ—Ç–µ—Ä–∏, –∞–ø–æ—Å—Ç—Ä–æ—Ñ —Ç–∞ –ø—Ä–æ–±—ñ–ª</span>
            </div>
            <div *ngIf="name.hasError('minlength')">
              <span>–Ü–º'—è –ø–æ–≤–∏–Ω–Ω–æ –º—ñ—Å—Ç–∏—Ç–∏ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ 2 —Å–∏–º–≤–æ–ª–∏</span>
            </div>
          </div>
        </div>
      </fieldset>

      <!-- Phone field -->
      <fieldset class="input-group has-validation">
        <div class="input-container">
          <div
            [class.is-invalid]="
              phoneNumber.invalid && (phoneNumber.dirty || phoneNumber.touched)
            "
            class="form-floating"
          >
            <ngx-intl-tel-input
              [class.is-invalid]="phoneNumber.invalid && phoneNumber.touched"
              [cssClass]="'form-control'"
              [preferredCountries]="preferredCountries"
              [enableAutoCountrySelect]="true"
              [customPlaceholder]="'–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É'"
              [searchCountryFlag]="false"
              [selectFirstCountry]="true"
              [phoneValidation]="true"
              [separateDialCode]="true"
              name="phone1"
              formControlName="phoneNumber"
            >
            </ngx-intl-tel-input>
          </div>
          <div class="invalid-feedback">
            <div
              *ngIf="phoneNumber.hasError('required') && phoneNumber.touched"
            >
              <span class="error-span">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π</span>
            </div>
            <div *ngIf="phoneNumber.hasError('validatePhoneNumber')">
              <span class="error-span">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É –Ω–µ–¥—ñ–π—Å–Ω–∏–π</span>
            </div>
          </div>
        </div>
      </fieldset>

      <!-- Email field -->
      <fieldset class="input-group has-validation">
        <div class="input-container">
          <div
            [class.is-invalid]="email.invalid && (email.dirty || email.touched)"
            class="form-floating"
          >
            <input
              [class.is-invalid]="
                email.invalid && (email.dirty || email.touched)
              "
              formControlName="email"
              type="text"
              class="form-control"
              placeholder="–ü–æ—à—Ç–∞"
            />
            <label>–ü–æ—à—Ç–∞</label>
          </div>
          <div class="invalid-feedback">
            <div *ngIf="email.hasError('required')">
              <span>Email –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π</span>
            </div>
            <div *ngIf="email.hasError('email') || email.hasError('minlength')">
              <span>Email –Ω–µ–¥—ñ–π—Å–Ω–∏–π</span>
            </div>
          </div>
        </div>
      </fieldset>

      <!-- Password field -->
      <fieldset class="input-group has-validation">
        <div class="input-container">
          <div
            [class.is-invalid]="
              password.invalid && (password.dirty || password.touched)
            "
            class="form-floating"
          >
            <input
              [class.is-invalid]="
                password.invalid && (password.dirty || password.touched)
              "
              formControlName="password"
              type="password"
              class="form-control"
              id="emailControl"
              placeholder="–ü–∞—Ä–æ–ª—å"
              autocomplete="on"
            />
            <label for="emailControl">–ü–∞—Ä–æ–ª—å</label>
          </div>
          <div class="invalid-feedback">
            <div *ngIf="password.hasError('required')">
              <span>–ü–∞—Ä–æ–ª—å –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π</span>
            </div>
            <div
              *ngIf="
                password.hasError('minlength') || password.hasError('pattern')
              "
            >
              <span
                >–ü–∞—Ä–æ–ª—å –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ —â–æ–Ω–∞–π–º–µ–Ω—à–µ 7 –ª—ñ—Ç–µ—Ä —Ç–∞ –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª
                (!&#64;#_$%^&*)</span
              >
            </div>
          </div>
        </div>
      </fieldset>

      <!-- Timezone selection field -->
      <fieldset class="input-group has-validation">
        <div class="input-container">
          <div
            [class.is-invalid]="
              timezone.invalid && (timezone.dirty || timezone.touched)
            "
            class="form-floating"
          >
            <select
              [class.is-invalid]="timezone.invalid && timezone.touched"
              id="timezone"
              formControlName="timezone"
              class="form-select"
            >
              <option
                *ngFor="let timezone of timezones"
                [value]="timezone.value"
              >
                {{ timezone.display }}
              </option>
            </select>
            <label for="timezone">–û–±–µ—Ä—ñ—Ç—å —á–∞—Å–æ–≤–∏–π –ø–æ—è—Å üïë</label>
          </div>
          <div class="invalid-feedback">
            <div *ngIf="timezone.hasError('required') && timezone.touched">
              <span class="error-span">–ß–∞—Å–æ–≤–∏–π –ø–æ—è—Å –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π</span>
            </div>
          </div>
        </div>
      </fieldset>

      <!-- Submit button -->
      <div class="w-100 d-flex justify-content-center">
        <button
          *ngIf="!awaitingResponse; else loadingBtn"
          type="submit"
          class="cta"
        >
          –°—Ç–≤–æ—Ä–∏—Ç–∏
        </button>
        <ng-template #loadingBtn>
          <button class="cta" type="button" disabled>
            <span
              class="spinner-grow spinner-grow-sm"
              aria-hidden="true"
            ></span>
            –ó–∞—á–µ–∫–∞–π—Ç–µ...
          </button>
        </ng-template>
      </div>
    </form>

    <img src="../../../assets/signup/signup.png" alt="Person with laptop" />
  </div>
</section>
